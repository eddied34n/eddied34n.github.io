<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Eddie">
  <meta name="description" content="Posts and writings by Eddie">
  <title>
    Dean's Pit
&ndash; External Network Discovery Tips for Pentesters  </title>

  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,800" rel="stylesheet" type="text/css">
  <link rel="shortcut icon" href="https://eddied34n.github.io/theme/images/logo.png">

  <link rel="stylesheet" type="text/css" href="https://eddied34n.github.io/theme/css/all.css">
  <link rel="stylesheet" type="text/css" href="https://eddied34n.github.io/theme/css/custom.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  
<meta name="keywords" content="network, recon">
</head>
<body>
  <div class="container">
    <div class="three columns sidebar">
<nav>
  <h1><a href="https://eddied34n.github.io/"></a>Dean's Pit</h1>
  <a href="https://eddied34n.github.io/">
    <img src="https://eddied34n.github.io/theme/images/logo.png" id="gravatar" alt="My photo"/>
  </a>
  <h2><i class="fa fa-ravelry" aria-hidden="true"></i> hola <i class="fa fa-ravelry" aria-hidden="true"></i></a></h2>

  <div id="bio">
    <p>Security Researcher, Network and Cloud Enthusiast. I will share the things I have just discovered here.</p>
  </div>

  <div id="social">
<div id="stalker" class="center">







  <a title="eddiethedean on Twitter" href="https://twitter.com/eddiethedean">
    <i class="fa fa-twitter"></i>
  </a>









  <a title="eddied34n on Github" href="https://github.com/eddied34n">
    <i class="fa fa-github"></i>
  </a>













</div>  </div>

  <div id="tags">
    <ul>
      </ul>
  </div>
</nav>    </div>

    <div class="twelve columns content">
  <p class="meta">
    25 Mayıs 2020
    <a href="/">
      <i class="home fa fa-home"></i>
    </a>
  </p>

  <h1 class="title"><a href="https://eddied34n.github.io/network-discovery-for-pentesters.html">External Network Discovery Tips for Pentesters</a></h1>
  
  <div class="article_text" id="post">
    <p>Greetings,</p>
<p>In this post, I'll share some techniques for finding targets in external and internal networks. I don't think I will go into too much details of 'how network works'. If you interest in network mechanics, I suggested some sources for further detailed information at the end of post. </p>
<p>In most legal attack scenarios (pentest, red team, bug hunting), the first stage goes through the identification of the target's resources. The data to be obtained at this stage determines the fate of the later stages of the project/scenario. In this article, I will talk about information that can be collected about the network.</p>
<p>Let's begin with external network recon.</p>
<h3>External Network Scoping</h3>
<p>I will be using a fake company name to explain this part. I will also make changes on IP addresses. But the techniques and the data to be obtained will be more or less the same.</p>
<h4>IP Address and ASN/Subnet Finding</h4>
<div class="highlight"><pre><span></span><span class="c1"># we can make DNS A query for domain with several tools and methods</span>
dig +short www.fakecorp.com 
nslookup www.fakecorp.com
host www.fakecorp.com

<span class="c1"># Let&#39;s assume IPv4 address of www.fakecorp.com is 1XX.X40.9.35. </span>
<span class="c1"># ASN Lookup with IP address and retrieve company name on BGP </span>
https://bgp.he.net/ip/1XX.X40.9.35

<span class="c1"># ASN Lookup with company/organization name</span>
https://bgp.he.net/search?search%5Bsearch%5D<span class="o">=</span>FakeCorp<span class="p">&amp;</span><span class="nv">commit</span><span class="o">=</span>Search

<span class="c1"># ASN lookup with IP Address on europe zone with RIPE</span>
https://apps.db.ripe.net/db-web-ui/query?searchtext<span class="o">=</span>1XX.X40.9.35

<span class="c1"># ASN lookup with `netname` value which retrieved befor on europe with RIPE</span>
https://apps.db.ripe.net/db-web-ui/query?searchtext<span class="o">=</span>FakeCorp

<span class="c1"># this is cool one which just waiting organization name</span>
http://asnlookup.com/
</pre></div>


<p>After all of these, you got several IP blocks for scanninng open ports.</p>
<h4>Finding Live Systems</h4>
<p>You probably blocked by firewalls, but first things first</p>
<div class="highlight"><pre><span></span>nmap -sn 1XX.X40.9.0/24

<span class="c1"># grep just IP addresses</span>
nmap -sn <span class="m">157</span>.240.9.0/24 -oG result.gnmap <span class="o">&amp;&amp;</span> cat result.gnmap <span class="p">|</span> grep <span class="s2">&quot;Status: Up&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span>

<span class="c1"># grep IP addresses and subdomain/domain names</span>
nmap -sn <span class="m">157</span>.240.9.0/24 -oG result.gnmap <span class="o">&amp;&amp;</span> cat result.gnmap <span class="p">|</span> grep <span class="s2">&quot;Status: Up&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2&quot; &quot;$3}&#39;</span>
</pre></div>


<p>Later, I'll writing about internal assets findings.</p>
<p>BB!</p>
<p>refs:
https://tools.ietf.org/html/rfc2929
https://www.ietf.org/rfc/rfc1035.txt
https://tools.ietf.org/html/rfc8499
https://tools.ietf.org/html/rfc5398
https://tools.ietf.org/html/rfc6996
https://tools.ietf.org/html/rfc7300</p>
  </div>

  <div class="article_meta related">
    <b>Category: </b> <a href="https://eddied34n.github.io/category/pentest.html">pentest</a>
    
    <br>
    <b>Tags: </b>
      <a href="https://eddied34n.github.io/tag/network.html">network</a>,      <a href="https://eddied34n.github.io/tag/recon.html">recon</a>  </div>



      <div class="footer">
<div class="disclaimer">
  
    <p>
      © Eddie  &mdash; built with 
      <i class="fa fa-heart" aria-hidden="true"></i> and 
      <i class="fa fa-coffee" aria-hidden="true"></i>.
    </p>
  </div>      </div>
    </div>
  </div>

</body>
</html>